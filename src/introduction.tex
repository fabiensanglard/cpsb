\chapter{Introduction} 

The origin of Capcom can be traced back to the founding of two companies by Kenzo Tsujimoto: I.R.M. Corporation in 1979 and its subsidiary Japan Capsule Computers Co in 1981. Located in Osaka prefecture, the two companies manufactured and distributed electrical games.

After a merger in 1981 the resulting entity, Sanbi, was rebranded "Capcom" in 1983. The first medal cabinet\cite{medal}, released the same year, was a baseball title named "Little League".

The nickname of their products, "\textbf{Cap}sule \textbf{Com}puters", summarized the values of the company. Intending to extend beyond the trendy personal computers of the era, the "coin-ops" were sold as "capsules packed to the brim with gaming fun". The hard outer shell embodied the desire to protect intellectual property and prevent illegal copies which were inferior imitations.


 In 1984, Capcom entered the world of video-games with their first title "Vulgus".
Arcades were a competitive world where cabinets had only a few seconds to catch the eyes of a customer. It was especially difficult for a company which, at the time, did not have the best technology.

\begin{q}{Noritaka Funamizu (a.k.a "Poo"), Capcom Game Planner\cite{planner}}
I always considered Capcom as someone fighting with a bamboo stick. We didn't have the resources to equal Sega's or Namco'
s hardware. 

While they were racing in F1 cars, we were driving Hondas.
\end{q}


\begin{figure}[H]
\img{1943.png}
\caption*{1943: The Battle of Midway by Capcom (1987)}
\end{figure}

The metaphor appears justified when comparing two titles from 1987 side by side: Capcom's "1943" (which Poo directed) and Sega's "Afterburner".

Sega's platform named "X Board", was in a league of its own. Its core ran on a dual 12.5 MHz Motorola 68000 CPUs. The graphic processor, Sega Super Scaler chipset clocked at 50MHz, was capable of both scaling and rotating up to 256 sprites over two background layers, and one "road" layer. 

Its sound system, ran by a 4MHz z80, sported a SegaPCM 16-channel stereo chip capable of rendering digitized sound effects far surpassing what could be achieved with the prevalent FM synthesis.

In the opposing corner, Capcom's valiant board featured a 6Mhz z80 CPU with a graphic system capable of animating 32 sprites on top of one text layer and two background layers\cite{1942-tech_specs}. 

The sound system, piloted via a second z80 running at 3Mhz, generated both music and sound effects via Yamaha FM synthesis.




\begin{figure}[H]
\img{afterburner.png}
\caption*{Afterburner by SEGA (1987)}
\end{figure}

Despite its simple graphics, 1943 sold honorably. It even managed to become the second highest-grossing table arcade game of 1987 thanks to its engaging gameplay. 

The dawn of Capcom history saw more titles doing well despite their limited technology. In 1985, "Wolf of the BattleField" (a.k.a Commando)\index{Games!Commando} conquered the world and particularly the UK where test locations resulted in orders totaling a thousand units\cite{cgm4}.

\begin{figure}[H]
\img{commando.png}
\caption*{Commando (1985)}
\end{figure}


\vfill

\begin{figure}[!b]
\img{commando_cabinet.png}
\caption*{USA distributor, Data East, prominently advertised the profitability!}
\end{figure}
\pagebreak


Released in 1984, Ghost'n Goblins\index{Games!Ghost'n Goblins} is another video-game which is emblematic of Capcom's capacity to do more with less in its early days. 

With the same "bamboo-stick" technology used in Commando, and the same planner (Tokuro Fujiwara) directing a small team made of programmer Toshio Arima, artist Masayoshi Kurokawa, and composer Ayako Mori, Ghost'n Goblins was another hit.

In this medieval fantasy inspired title, the hero is to rescue an abducted lover. Arthur had to face hordes of Zombies, Magicians, Skeletons, Red Arremers, Flying Knights, and the most unforgiving control system known to mankind.

The story was well put together. Bosses such as Unicorns, Dragons, Satan, and the chief Astaroth were well-animated. Despite its nightmare inducing difficulty, players liked the game. 

\vfill 

\begin{figure}[H]
\img{gb.png}
\caption*{Ghost’n Goblins (1984)}
\end{figure}
\pagebreak

It became the 10\textsuperscript{th} highest-grossing arcade game in Japan and reached 9\textsuperscript{th} in the US.
\vfill 
\begin{figure}[H]
\img{gb_flyer.png}
\caption*{Ghost’n Goblins flyer (1984)}
\end{figure}
\pagebreak

What Capcom lacked in raw power, they made up with imagination and tinkering. But wit was not always enough. In 1987, Capcom published "Street Fighter", an audaciously innovative title but a commercial failure.

In "Street Fighter", players controlled their characters with a standard joystick but used two large pneumatic pushers for kicks and punches. Pipes conducted air to the board where pressure was measured. The harder a player punched the button, the higher the damage inflicted.

Without tactile feedback, players tended to smash as hard as possible, forgetting to manage their effort. After a few rounds the right arm was shot and fatigue made rounds not fun. Besides enjoyment, there were also the issues of injuries and tendinitis. To rectify, Capcom retrofitted the control system with something more "standard" while still allowing players to select the power via six "normal" buttons. 

The game became playable but doomed by unimpressive graphics and sluggish controls. The cabinet was largely ignored and despite attempts to boost sales with discounts, "the most amazing dedicated upright ever" soon fell into oblivion.


\begin{figure}[H]
\img{sf1_4_3.png}
\caption*{Street Fighter 1 (1987)}
\end{figure}


\begin{figure}[H]
\img{sf1_cabinet.png}
\caption*{Street Fighter 1 cabinet flyer}
\end{figure}


\section{Costly Production}
Besides facing technologically superior competitors, Capcom had to deal with a constantly evolving production pipeline. Looking at the Printed Circuit Boards\index{PCB!Printed Circuit Boards} (PCBs)\index{PCB} hosting their games from 1984 to 1988 reveals a high variation of components.

Summarizing Capcom's usage of the Motorola 6809, Zilog z80, Motorola m68k, Intel 8751 (MCU), YM2203, YM2151, YM2149, and MSM5205 in a table shows that even titles produced the same year wouldn't necessarily feature the same chips. 

Even the ubiquitous z80 was used inconsistently since it could be dedicated to game logic, audio, or both like in the "1942" board which features two of them.



\begin{figure}[H]
{ 
\setlength{\tabcolsep}{3.0pt}
\setlength\cmidrulewidth{\heavyrulewidth} % Make cmidrule = 
\begin{tabularx}{\textwidth}{Xccccccccc}

  & & \multicolumn{4}{c}{CPU} &  \multicolumn{4}{c}{SOUNDS} \\
  \cmidrule(lr){3-6}
  \cmidrule(lr){7-10}
 
  \textbf{Game Name} & \textbf{Year} & \textbf{M6809} & \textbf{z80} & \textbf{m68k} & \textbf{i8751} & \textbf{2203} & \textbf{2151} & \textbf{2149} & \textbf{5205} \\               
  \toprule    
\href{https://www.youtube.com/watch?v=45ELzG1ivEA}{Vulgus}
                & 1984          &               &      X       &              &              &               &               &       X       &               \\
\href{https://www.youtube.com/watch?v=R5mg6XPqtBs}{Higemaru}
                & 1984          &               &      X       &              &              &               &               &       X       &               \\
\href{https://www.youtube.com/watch?v=Em7UwOOBvlA}{1942}
                & 1984          &               &      X       &              &              &               &               &       X       &               \\
  \toprule    
\href{https://www.youtube.com/watch?v=1qctKI_t5eY}{Commando}
                & 1985          &               &      X       &              &              &       X       &               &       X       &               \\
\href{https://www.youtube.com/watch?v=SugLAqaPhqA}{Ghost'n Goblins}  
                & 1985          &       X       &      X       &              &              &       X       &               &       X       &               \\
\href{https://www.youtube.com/watch?v=mrO9qwGXdy8}{Gun Smoke}        
                & 1985          &               &      X       &              &              &       X       &               &       X       &               \\
\href{https://www.youtube.com/watch?v=cIC2mNNryZg}{Section Z}
                & 1985          &               &      X       &              &              &       X       &               &       X       &               \\
  \toprule    
\href{https://www.youtube.com/watch?v=L1FVWdlQNG8}{Trojan}
                & 1986          &               &      X       &              &              &       X       &               &               &       X       \\
\href{https://www.youtube.com/watch?v=57lg9pFUgco}{Speed Rumbler}
                & 1986          &       X       &      X       &              &              &       X       &               &       X       &               \\
\href{https://www.youtube.com/watch?v=0QyLx94PMio}{Dyn Side Arms}
                & 1986          &               &      X       &              &              &       X       &               &       X       &               \\
\href{https://www.youtube.com/watch?v=0f4jWQyf-fs}{Legendary Wings}
                & 1986          &               &      X       &              &              &       X       &               &       X       &               \\
  \toprule    
\href{https://www.youtube.com/watch?v=kntCwchJWfw}{1943}
                & 1987          &               &      X       &              &              &       X       &               &       X       &               \\
\href{https://www.youtube.com/watch?v=ZzKStmMAiHM}{Black Tiger}
                & 1987          &               &      X       &              &      X       &       X       &               &       X       &               \\
\href{https://www.youtube.com/watch?v=kVLCv-YgWco}{Street Fighter}
                & 1987          &               &      X       &      X       &      X       &               &       X       &               &       X       \\
\href{https://www.youtube.com/watch?v=1ZtwOGN-ZeE}{Tiger Road}
                & 1987          &               &      X       &      X       &              &       X       &               &       X       &       X       \\
  \toprule    
\href{https://www.youtube.com/watch?v=zG620nr7vko}{Bionic Commando}
                & 1988          &               &      X       &      X       &      X       &               &       X       &               &               \\
\href{https://www.youtube.com/watch?v=zG620nr7vko}{F1-Dream}
                & 1988          &               &      X       &      X       &      X       &       X       &               &       X       &               \\
  \toprule    
\end{tabularx}%
}\caption*{Usage of chips in Capcom arcades from 1984 to 1988\cite{cps0chipslist}.}
\label{fig:capcom_pcbs}
\end{figure}


Even though games did mostly the same thing (move sprites over backgrounds), the hardware had to be re-invented over and over again. 

The evolving pipeline slowed down production since game programming pace was hindered by bugs in the hardware. Full speed could only be achieved in the later stages of development which placed Capcom at a further disadvantage to its competitors.





\section{Plagued by piracy}
Since Capcom's PCBs were made with off-the-shelf components, counterfeiters where able to copy them, dump the software ROMs and build replicas called "bootlegs". 

Without having to offset the cost of development, these copies sold for less than official games. The missed sales weighed heavily on Capcom's financial health. 




\section{Capcom NT (New Technology)}
Production difficulties, competition, and piracy painted an uncertain future for Capcom's arcade division. As history would have it, they not only survived, they thrived.

A new era began in 1988. With the release of Forgotten Worlds and Strider, players got a first glimpse into the kind of games the Osaka company was now capable of.  



\label{nin_fw}
\begin{figure}[H]
\img{fw_4_3.png}
\caption*{Forgotten Worlds (1988)}
\end{figure}



 
\label{fw_flyer}
  \begin{figure}[H]
  \img{cps1_announcement.jpg}
  \caption*{Capcom's CPS-1 announcement flyer (1989)}
  \end{figure}

With both games using a mysterious "new technology" (later renamed \textbf{CP-System} and \textbf{CPS-1}), production quality was greatly improved. Massive sprites moved on the screen. They were made of many more colors and evolved on top of several layers simulating parallax. Levels were more elaborate (Strider had impressive climbable sloped surfaces). The audio was not in rest with both digitized sounds and music samples.

Capcom's first mega-hit came with "Final Fight"\index{Games!Final Fight} in 1989. Up to that point in time, the "beat 'em up" genre had been dominated by Technos thanks to its excellent series of Kunio-kun (known outside of Japan as "Renegade") and the mega-hit Double Dragon. 

With Cody, Guy, and Mike, Capcom cleared the room. Despite a minuscule budget of 2MiB for the graphics, the art team, let by Akira Yasuda (a.k.a Akiman) used the full capability of the CPS-1 to provide gorgeous visuals and engaging music. The game-play was fantastic with various enemies, bosses, and skill-specific heroes. More importantly the timing was right for the US market where "beat 'em up" was all the rage.



  

\label{nin_ff}
 \begin{figure}[H]
\img{ff_4_3.png}
\caption*{Final Fight (1989)}
\end{figure}

"Final Fight" soon became Capcom's top-selling game\cite{birth_of_chunli} and established the company as an unarguable arcade powerhouse.

\pagebreak

Perhaps the best compliment came from competitors who, years later, would admit to the demoralizing effect "Final Fight" had on them.

\begin{q}{Yoshihisa Kishimoto, Planner (Double Dragon \& Kunio-kun)\cite{dd} }
  

  The people from Capcom hurt Technos Japan a lot with Final Fight which was superior on every level to Double Dragon III. Not only they had amazing designers, they also gave their teams means to innovate on the hardware level (CPS-1). 

  For us it was an horrible awakening because it proved we had been unable to evolve as fast as them.
  %<ref src="">Yoshihisa Kishimoto, Enter The Double Dragon: p142</ref>
  \end{q}



Not only was quality improved, quantity also increased. Thanks to its stable platform and tools, Capcom was able to release more than thirty titles between 1988 and 1995, all based on its CPS-1 platform. 

Among them was the "Street Fighter 1" sequel which took the world over by storm.

\label{nin_sf2}
\begin{figure}[H]
\img{sf2_4_3.png}
\caption*{Street Fighter 2 (1991)}
\end{figure}

\index{Games!All from 1988 to 1995}
\begin{figure}[H]
{ \setlength{\tabcolsep}{3.0pt}
\begin{tabularx}{\textwidth}{Xrr} 
  \textbf{Game Name} & \textbf{ GFX }  & \textbf{ Year } \\               
  \toprule    
\href{}{Forgotten Worlds} & 4 MiB & 1988 \\ 
\href{}{Ghouls'n Ghosts} & 3 MiB & 1988 \\ 
  \toprule    
\href{}{Strider} & 4 MiB & 1989 \\ 
\href{}{Dynasty Wars} & 8 MiB & 1989 \\ 
\href{}{Willow} & 4 MiB & 1989 \\ 
\href{}{U.N Squadron} & 2 MiB & 1989 \\ 
\href{}{Final Fight} & 2 MiB & 1989 \\ 
  \toprule    
\href{}{1941: Counter Attack} & 2 MiB &  1990 \\ 
\href{}{Mercs} &  3 MiB & 1990 \\ 
\href{}{Mega Twins} & 2 MiB & 1990 \\ 
\href{}{Magic Sword} & 2 MiB & 1990 \\ 
\href{}{Carrier Air Wing} & 2 MiB  & 1990 \\ 
\href{}{Nemo} & 2 MiB &  1990 \\ 
  \toprule    
\href{}{Street Fighter II: The World Warrior} & 6 MiB & 1991 \\ 
\href{}{Three Wonders} & 4 MiB & 1991 \\ 
\href{}{The King of Dragons} & 4 MiB & 1991 \\ 
\href{}{Captain Commando} &  4 MiB & 1991 \\ 
\href{}{Knights of the Round} & 4 MiB  & 1991 \\ 
  \toprule    
\href{}{Street Fighter II: Champion Edition} & 6 MiB & 1992 \\ 
\href{}{Adventure Quiz: Capcom World 2} & 2 MiB & 1992 \\ 
\href{}{Varth: Operation Thunderstorm} & 2 MiB & 1992 \\ 
\href{}{Quiz \& Dragons: Capcom Quiz Game} & 2 MiB & 1992 \\ 
\href{}{Street Fighter II' Turbo: Hyper Fighting} &  6 MiB & 1992 \\ 
  \toprule    
\href{}{Ken Sei Mogura: Street Fighter II} & 6 MiB & 1993 \\ 
\href{}{Pnickies} & 2 MiB & 1993 \\ 
  \toprule    
\href{}{Quiz Tonosama no Yabo 2} &  4 MiB & 1995 \\ 
\href{}{Pang! 3} & 2 MiB  & 1995 \\ 
Mega Man the Power Battle & 8 MiB  & 1995 \\

\toprule    
\end{tabularx}%
}\caption*{Capcom CPS-1 based arcade games from 1988 to 1995.}
\end{figure}




Sitting at the intersection of Capcom's new found technology and the "more-with-less" skills its teams had acquired out of necessity, "Street Fighter 2"\index{Games!Street Fighter 2} was a quantum leap in gaming that resulted in a phenomenon.  

The eight characters came in different sizes, shapes and genders. They each had their own moves and special abilities. These characterizations gave them depth. The music was engaging, the audio effects crisp. The precision of controls invited players to build up their skills and master their avatar. 

The hardware was capable of breathtaking per-line parallax running at a consistent, butter-smooth 60Hz to showcase the artistic team's talent. 


\begin{figure}[H]
\img{sf2_tournament.png}
\caption*{Street Fighter 2 tournament flyer}
\end{figure}

The game immediately developed a cult following. Players had to wait in lines to drop a quarter. Purchasing "Continue" was frowned upon by other players impatiently waiting for their turns. Operators purchased multiple copies of the game to reduce the wait time, and at the end of the day machines still overflowed with coins\cite{sf2_oral_history}.

The popularity was such that tournaments with handsome rewards (opposing page) were held. 

By 1995, the series had generated \$2.3 billion with 200,000 cabinets sold\cite{usgamer20160101} (60,000 World Warriors units and 140,000 Champion Edition units). By 2017 that figure reached \$10.61 billion\cite{gamerevolution20140126}, making "Street Fighter 2" the third top grossing game of all time.

\begin{trivia}
Did you notice this ubiquitous player nicknamed \textbf{NiN} who owns all the high-scores of Forgotten Worlds (p\pageref{nin_fw}), Final Fight (p\pageref{nin_ff}), and Street Fighter II (p\pageref{nin_sf2})? It is the pseudonym of Akira Nishitani, the gameplay planner on all these titles!
\end{trivia}

\section{Ode to CP-System}

This book is a engineering love letter to the system that enabled Capcom to evolve from a company fighting for survival to become an arcade household name.

The goal of this work is to understand the CP-System, from the bottom to the top. This will (hopefully) be achieved by first exposing the hardware and then progressively moving up, all the way to the programming and game engine architecture level.

\subsubsection{Hardware}
The hardware of the four systems making the CP-System is explored in the first chapter.
\begin{itemize}[topsep=0pt]
\item Control System
\item Audio System
\item GFX System
\item Video System
\end{itemize}
 Beyond the hard reality of silicon and bus lines, a discussion of the design choices and real-life examples of how games leveraged features is provided when relevant.


\subsubsection{Software}
The subsequent chapters study the software and how to build it. In particular the four ROM groups resulting in a game are explained. 

\begin{itemize}[topsep=0pt]
\item Motorola m68k ROM
\item Zilog z80 programming and YM2151 (music) ROM
\item MSM6295 (audio samples) ROM
\item CPS-A/CPS-B (GFX) ROM
\end{itemize}

These chapters use modern tooling but also feature a "Back in the days" section which explores how Capcom used to work back in the 90s.

\subsubsection{Peopleware}
People involved with either hardware or software are quoted in the relevant sections. However, Capcom was already a big company by the early 90s and many ended up participating to the history of the CPS-1. To help the reader keep track of all the actors, a summary "people" chapter is available on page \pageref{people}.
